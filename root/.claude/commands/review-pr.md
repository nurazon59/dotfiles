# PRレビューコマンド

このコマンドは、現在のブランチに対して包括的なレビューを実行します。

## 実行手順

1. **事前準備**
   - 現在のブランチとmainブランチの差分を確認
   - 変更されたファイルのリストを取得
   - git statusとgit diffを確認

2. **静的解析フェーズ**
   - Linterの実行（プロジェクトに応じて）
   - Type checkの実行（TypeScript/Flow等の場合）
   - フォーマットチェック
   - 結果を記録

3. **並列レビューフェーズ（10個のagentを並列起動）**

   以下のagentを並列で起動してレビューを実行してください：

   ### Agent 1: コード品質レビュー
   - タスク: general-purpose
   - 観点:
     - コーディング規約の遵守
     - ベストプラクティスの適用
     - コードの可読性
     - 命名規則
     - 重複コードの検出

   ### Agent 2: セキュリティレビュー
   - タスク: general-purpose
   - 観点:
     - XSS、CSRF、SQLインジェクション等の脆弱性
     - 認証・認可の実装
     - 機密情報の扱い
     - 入力バリデーション
     - セキュリティヘッダー

   ### Agent 3: パフォーマンスレビュー
   - タスク: react-frontend-specialist (React/Frontend系の場合)
   - タスク: general-purpose (その他)
   - 観点:
     - 不要な再レンダリング
     - メモリリーク
     - 重い処理の最適化
     - バンドルサイズ
     - N+1クエリ問題

   ### Agent 4: テストレビュー
   - タスク: general-purpose
   - 観点:
     - テストカバレッジ
     - テストケースの妥当性
     - エッジケースのテスト
     - モックの適切な使用
     - テストの保守性

   ### Agent 5: ドキュメントレビュー
   - タスク: general-purpose
   - 観点:
     - README、コメントの更新
     - APIドキュメントの整合性
     - 変更内容の説明
     - 例の提供
     - 破壊的変更の明記

   ### Agent 6: エラーハンドリングレビュー
   - タスク: general-purpose
   - 観点:
     - エラーの適切な処理
     - エラーメッセージの分かりやすさ
     - 例外の適切な使用
     - リトライロジック
     - ログ出力

   ### Agent 7: 型安全性レビュー
   - タスク: general-purpose
   - 観点:
     - 型定義の完全性
     - any型の使用回避
     - 型ガードの適切な使用
     - Null/undefinedの処理
     - 型推論の活用

   ### Agent 8: アーキテクチャレビュー
   - タスク: general-purpose
   - 観点:
     - 設計パターンの適切な適用
     - 責任の分離
     - 依存関係の管理
     - モジュール構成
     - スケーラビリティ

   ### Agent 9: アクセシビリティレビュー（UI変更がある場合）
   - タスク: general-purpose
   - 観点:
     - ARIA属性の使用
     - キーボード操作対応
     - スクリーンリーダー対応
     - コントラスト比
     - セマンティックHTML

   ### Agent 10: 動作確認レビュー（UI変更がある場合）
   - タスク: playwright-browser-verifier
   - 観点:
     - 実際のブラウザでの動作確認
     - ユーザーフローのテスト
     - レスポンシブ対応
     - クロスブラウザ対応
     - エラー状態の表示

4. **レビュー結果の集約**
   - 各agentからの結果を収集
   - 重要度別に分類（Critical / High / Medium / Low）
   - `zzz/review-result-{ブランチ名}-{日付}.md`にまとめる

5. **レポート生成**

   以下のフォーマットでレビュー結果をまとめてください：

   ```markdown
   # PRレビュー結果

   **ブランチ**: {ブランチ名}
   **レビュー日時**: {日時}
   **変更ファイル数**: {数}
   **変更行数**: {追加}/{削除}

   ## 概要

   {変更内容の簡単なサマリー}

   ## 静的解析結果

   ### Lint結果
   - {結果}

   ### Type Check結果
   - {結果}

   ### Format Check結果
   - {結果}

   ## レビュー結果

   ### ✅ 良い点
   - {良い点のリスト}

   ### 🔴 Critical（即座に修正が必要）
   - {Criticalな問題のリスト}

   ### 🟠 High（リリース前に修正すべき）
   - {Highな問題のリスト}

   ### 🟡 Medium（可能であれば修正）
   - {Mediumな問題のリスト}

   ### 🟢 Low（改善提案）
   - {Lowな問題のリスト}

   ## 各観点別の詳細

   ### 1. コード品質
   {詳細}

   ### 2. セキュリティ
   {詳細}

   ### 3. パフォーマンス
   {詳細}

   ### 4. テスト
   {詳細}

   ### 5. ドキュメント
   {詳細}

   ### 6. エラーハンドリング
   {詳細}

   ### 7. 型安全性
   {詳細}

   ### 8. アーキテクチャ
   {詳細}

   ### 9. アクセシビリティ
   {詳細}

   ### 10. 動作確認
   {詳細}

   ## 推奨アクション

   1. {アクション1}
   2. {アクション2}
   ...

   ## 総合評価

   {総合的な評価とコメント}
   ```

## 使用例

```
/review-pr
```

## 注意事項

- レビューには5-10分程度かかります
- 10個のagentを並列で起動するため、一度に大量のリクエストが発生します
- UI変更がない場合、Agent 9と10は簡略化またはスキップされます
- レビュー結果は`zzz/`ディレクトリに保存されます（Git管理外）
